<!DOCTYPE html>
<html>
<style>
table, td, th {
  border: 1px solid black;
}

table {
  border-collapse: collapse;
  width: 100%;
}

th {
  height: 70px;
}
</style>
<body>
<div id="demo2">
<button type="button" onclick="loadGet()">Leaderboard</button>
</div>

<h2>Scoreboard</h2>

<table>
  <tr>
    <th>Name</th>
    <th>Points</th>
  </tr>
  <tr>
    <td><div id="user0"></div></td>
    <td><div id="point0"></td>
  </tr>
  <tr>
    <td><div id="user1"></div></td>
    <td><div id="point1"></td>
  </tr>
  <tr>
    <td><div id="user2"></div></td>
    <td><div id="point2"></td>
  </tr>
  <tr>
    <td><div id="user3"></div></td>
    <td><div id="point3"></td>
  </tr>
  <tr>
    <td><div id="user4"></div></td>
    <td><div id="point4"></td>
  </tr>
  <tr>
    <td><div id="user5"></div></td>
    <td><div id="point5"></td>
  </tr>
  <tr>
    <td><div id="user6"></div></td>
    <td><div id="point6"></td>
  </tr>
  <tr>
    <td><div id="user7"></div></td>
    <td><div id="point7"></td>
  </tr>
  <tr>
    <td><div id="user8"></div></td>
    <td><div id="point8"></td>
  </tr>
  <tr>
    <td><div id="user8"></div></td>
    <td><div id="point8"></td>
  </tr>
  <tr>
    <td><div id="user9"></div></td>
    <td><div id="point9"></td>
  </tr>
  <tr>
    <td><div id="user10"></div></td>
    <td><div id="point10"></td>
  </tr>
</table>
<a href="http://68.183.195.190/point1.html">Point 1</a>
<a href="http://68.183.195.190/login.html">Log In</a>
<a href="http://68.183.195.190/register.html">Register</a>
</script>
<div id="loggedin">
</div>
<script>
document.addEventListener("DOMContentLoaded", function() {
  lmao();
})
function loadGet() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("demo2").innerHTML =
      this.responseText;
	  const scoreboardinfo = this.responseText.split(",");
		let tempuser = "user";
		let point = "point";
		let x = 0
		for(;x< scoreboardinfo.length-1;x+=2)
		{
			document.getElementById(tempuser.concat(((x/2)+1).toString())).innerHTML = scoreboardinfo[x];
			document.getElementById(point.concat(((x/2)+1).toString())).innerHTML = scoreboardinfo[x+1];
		}
		for(; x < 19; x+=2)
		{
			document.getElementById(tempuser.concat(((x/2)+1).toString())).innerHTML = "";
			document.getElementById(point.concat(((x/2)+1).toString())).innerHTML = "";
		}

    }
  };
  xhttp.open("GET", "http://68.183.195.190:8000/users", true);
  xhttp.send();

}
function setCookie(cname, cvalue, exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
  let expires = "expires="+d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
function loginScript(username) {
  var xhttp = new XMLHttpRequest();
  xhttp.open("POST", "http://68.183.195.190:8000/login", true);
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
		if (this.responseText == 512)
		{
			setCookie("username", "", 1) 
		}
    }
  };
  xhttp.setRequestHeader('Content-Type', 'application/json');
xhttp.send(JSON.stringify({
    user: username,

}));
  };
function lmao()
{
	if (getCookie("username") != "")
	{
		loginScript(getCookie("username"))
		if (getCookie("username") != "")
		{
			document.getElementById("loggedin").innerHTML ="Logged in as " + getCookie("username");
		}
		else
		{
			document.getElementById("loggedin").innerHTML =" You are not logged in";
		}
	}
	else
	{
		document.getElementById("loggedin").innerHTML =" You are not logged in";
	}
}
</script>
</body>
</html>
